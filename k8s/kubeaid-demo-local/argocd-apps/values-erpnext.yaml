---
erpnext:
  # Database connection (using MariaDB operator)
  dbHost: erpnext-mariadb
  dbPort: 3306
  dbRootUser: root
  dbRootPassword: erpnext-secret-password
  dbRds: false

  # Persistence using local-path storage class from k3d
  persistence:
    worker:
      enabled: true
      size: 8Gi
      storageClass: "local-path"
      accessModes:
        - ReadWriteOnce

  # Image configuration
  image:
    repository: frappe/erpnext
    tag: v15.91.0
    pullPolicy: IfNotPresent

  # Nginx configuration
  nginx:
    replicaCount: 1
    service:
      type: ClusterIP
      port: 8080
    resources:
      requests:
        cpu: 50m
        memory: 64Mi
      limits:
        memory: 128Mi

  # Worker configuration
  worker:
    gunicorn:
      replicaCount: 1
      resources:
        requests:
          cpu: 100m
          memory: 256Mi
        limits:
          memory: 512Mi
    default:
      replicaCount: 1
      resources:
        requests:
          cpu: 50m
          memory: 128Mi
        limits:
          memory: 256Mi
    short:
      replicaCount: 1
      resources:
        requests:
          cpu: 50m
          memory: 128Mi
        limits:
          memory: 256Mi
    long:
      replicaCount: 1
      resources:
        requests:
          cpu: 50m
          memory: 128Mi
        limits:
          memory: 256Mi
    scheduler:
      replicaCount: 1
      resources:
        requests:
          cpu: 50m
          memory: 128Mi
        limits:
          memory: 256Mi

  # Jobs configuration
  jobs:
    configure:
      enabled: true
      fixVolume: true
    createSite:
      enabled: true
      siteName: "erpnext.nordicsource.eu"
      adminPassword: "admin"
      installApps:
        - "erpnext"
      dbType: "mariadb"

  # External Redis configuration (using Redis operator)
  externalRedis:
    cache: "redis://erpnext-redis-cache:6379"
    queue: "redis://erpnext-redis-queue:6379"

  # Disable bundled databases - we use operators
  mariadb:
    enabled: false
  redis-cache:
    enabled: false
  redis-queue:
    enabled: false
  dragonfly-cache:
    enabled: false
  dragonfly-queue:
    enabled: false

  # Ingress configuration
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt
      kubernetes.io/ingress.class: nginx
    hosts:
      - host: erpnext.nordicsource.eu
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - secretName: erpnext-tls
        hosts:
          - erpnext.nordicsource.eu

# MariaDB operator instance configuration
mariadb:
  rootPasswordSecretKeyRef:
    name: erpnext-mariadb-root-secret
    key: password
    generate: true
  storage:
    size: 10Gi
    storageClassName: local-path
    resizeInUseVolumes: true
    waitForVolumeResize: true
  image: "mariadb:11.6.2-noble"
  imagePullPolicy: IfNotPresent

# Redis operator instances configuration
redisCache:
  storage: 2Gi

redisQueue:
  storage: 2Gi
